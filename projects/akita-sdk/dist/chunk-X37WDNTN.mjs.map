{"version":3,"sources":["../src/connect/uri.ts"],"sourcesContent":["/**\n * Encode/decode helpers for the liquid:// connect URI scheme.\n *\n * URI format: liquid://<signaling-server-host>?requestId=<uuid>\n */\n\nimport type { AkitaConnectUri } from './types';\n\n/**\n * Encode a connect URI from its components.\n *\n * @example\n * encodeConnectUri({ origin: \"signal.akita.community\", requestId: \"abc-123\" })\n * // => \"liquid://signal.akita.community?requestId=abc-123\"\n */\nexport function encodeConnectUri({ origin, requestId }: AkitaConnectUri): string {\n  return `liquid://${origin}?requestId=${encodeURIComponent(requestId)}`\n}\n\n/**\n * Decode a liquid:// connect URI into its components.\n *\n * @throws {Error} If the URI is not a valid liquid:// connect URI or is missing requestId.\n */\nexport function decodeConnectUri(uri: string): AkitaConnectUri {\n  const trimmed = uri.trim()\n\n  if (!trimmed.toLowerCase().startsWith('liquid://')) {\n    throw new Error(`Invalid connect URI: expected liquid:// scheme, got \"${trimmed}\"`)\n  }\n\n  // Replace liquid:// with https:// so URL parser can handle it\n  const asHttps = 'https://' + trimmed.slice('liquid://'.length)\n  const parsed = new URL(asHttps)\n\n  const origin = parsed.host\n  if (!origin) {\n    throw new Error(`Invalid connect URI: missing host in \"${trimmed}\"`)\n  }\n\n  const requestId = parsed.searchParams.get('requestId') || parsed.searchParams.get('request_id')\n  if (!requestId) {\n    throw new Error(`Invalid connect URI: missing requestId parameter in \"${trimmed}\"`)\n  }\n\n  return { origin, requestId }\n}\n"],"mappings":";AAeO,SAAS,iBAAiB,EAAE,QAAQ,UAAU,GAA4B;AAC/E,SAAO,YAAY,MAAM,cAAc,mBAAmB,SAAS,CAAC;AACtE;AAOO,SAAS,iBAAiB,KAA8B;AAC7D,QAAM,UAAU,IAAI,KAAK;AAEzB,MAAI,CAAC,QAAQ,YAAY,EAAE,WAAW,WAAW,GAAG;AAClD,UAAM,IAAI,MAAM,wDAAwD,OAAO,GAAG;AAAA,EACpF;AAGA,QAAM,UAAU,aAAa,QAAQ,MAAM,YAAY,MAAM;AAC7D,QAAM,SAAS,IAAI,IAAI,OAAO;AAE9B,QAAM,SAAS,OAAO;AACtB,MAAI,CAAC,QAAQ;AACX,UAAM,IAAI,MAAM,yCAAyC,OAAO,GAAG;AAAA,EACrE;AAEA,QAAM,YAAY,OAAO,aAAa,IAAI,WAAW,KAAK,OAAO,aAAa,IAAI,YAAY;AAC9F,MAAI,CAAC,WAAW;AACd,UAAM,IAAI,MAAM,wDAAwD,OAAO,GAAG;AAAA,EACpF;AAEA,SAAO,EAAE,QAAQ,UAAU;AAC7B;","names":[]}