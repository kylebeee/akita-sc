{"version":3,"sources":["../src/base.ts"],"sourcesContent":["import { AlgorandClient } from \"@algorandfoundation/algokit-utils/types/algorand-client\";\nimport { DEFAULT_READER, DEFAULT_SEND_PARAMS, SIMULATE_PARAMS } from \"./constants\";\nimport { resolveAppIdWithClient, ENV_VAR_NAMES, detectNetworkFromClient, getCurrentNetwork, AkitaNetwork } from \"./config\";\nimport { ExpandedSendParams, ExpandedSendParamsWithSigner, hasSenderSigner, MaybeSigner, NewBaseContractSDKParams } from \"./types\";\nimport { makeEmptyTransactionSigner } from \"algosdk\";\n\nexport abstract class BaseSDK<T> {\n  public appId: bigint;\n  public client: T;\n  public algorand: AlgorandClient;\n  public readerAccount: string = DEFAULT_READER;\n  public sendParams: ExpandedSendParams = DEFAULT_SEND_PARAMS;\n  \n  /** The detected network for this SDK instance */\n  public network: AkitaNetwork;\n\n  /**\n   * Override this in subclasses to specify the environment variable name for the app ID\n   */\n  protected static envVarName: string = '';\n\n  constructor({ factoryParams, algorand, factory, readerAccount, sendParams }: NewBaseContractSDKParams<T>, envVarName?: string) {\n    // Detect network from AlgorandClient\n    this.network = detectNetworkFromClient(algorand);\n    \n    // Resolve app ID from provided value, environment, or network config\n    const resolvedAppId = resolveAppIdWithClient(\n      algorand,\n      factoryParams.appId,\n      envVarName || (this.constructor as typeof BaseSDK).envVarName || '',\n      this.constructor.name\n    );\n    \n    this.appId = resolvedAppId;\n    this.algorand = algorand;\n    if (readerAccount) { this.readerAccount = readerAccount; }\n    if (sendParams) { this.sendParams = sendParams; }\n\n    if (!!factoryParams.defaultSender) {\n      this.sendParams.sender = factoryParams.defaultSender;\n    }\n    if (!!factoryParams.defaultSigner) {\n      this.sendParams.signer = factoryParams.defaultSigner;\n    }\n\n    // Create the client with the resolved app ID\n    this.client = new factory({ algorand }).getAppClientById({\n      ...factoryParams,\n      appId: resolvedAppId,\n    });\n  }\n\n  setReaderAccount(readerAccount: string): void {\n    this.readerAccount = readerAccount;\n  }\n\n  setSendParams(sendParams: ExpandedSendParams): void {\n    this.sendParams = sendParams;\n  }\n\n  protected getSendParams({ sender, signer }: MaybeSigner = {}): ExpandedSendParams {\n    return {\n      ...this.sendParams,\n      ...(sender !== undefined && { sender }),\n      ...(signer !== undefined && { signer }),\n    };\n  }\n\n  protected getRequiredSendParams(params: MaybeSigner = {}): ExpandedSendParamsWithSigner {\n    const sendParams = this.getSendParams(params);\n    if (!hasSenderSigner(sendParams)) {\n      throw new Error('Sender and signer must be provided either explicitly or through defaults at SDK instantiation');\n    }\n    return sendParams;\n  }\n\n  protected getReaderSendParams({ sender }: { sender?: string } = {}): ExpandedSendParams {\n    return {\n      ...this.sendParams,\n      ...(sender !== undefined ? { sender } : { sender: this.readerAccount }),\n      signer: makeEmptyTransactionSigner()\n    };\n  }\n}"],"mappings":";;;;;;;;;;;AAIA,SAAS,kCAAkC;AAEpC,IAAe,UAAf,MAA0B;AAAA,EACxB;AAAA,EACA;AAAA,EACA;AAAA,EACA,gBAAwB;AAAA,EACxB,aAAiC;AAAA;AAAA,EAGjC;AAAA;AAAA;AAAA;AAAA,EAKP,OAAiB,aAAqB;AAAA,EAEtC,YAAY,EAAE,eAAe,UAAU,SAAS,eAAe,WAAW,GAAgC,YAAqB;AAE7H,SAAK,UAAU,wBAAwB,QAAQ;AAG/C,UAAM,gBAAgB;AAAA,MACpB;AAAA,MACA,cAAc;AAAA,MACd,cAAe,KAAK,YAA+B,cAAc;AAAA,MACjE,KAAK,YAAY;AAAA,IACnB;AAEA,SAAK,QAAQ;AACb,SAAK,WAAW;AAChB,QAAI,eAAe;AAAE,WAAK,gBAAgB;AAAA,IAAe;AACzD,QAAI,YAAY;AAAE,WAAK,aAAa;AAAA,IAAY;AAEhD,QAAI,CAAC,CAAC,cAAc,eAAe;AACjC,WAAK,WAAW,SAAS,cAAc;AAAA,IACzC;AACA,QAAI,CAAC,CAAC,cAAc,eAAe;AACjC,WAAK,WAAW,SAAS,cAAc;AAAA,IACzC;AAGA,SAAK,SAAS,IAAI,QAAQ,EAAE,SAAS,CAAC,EAAE,iBAAiB;AAAA,MACvD,GAAG;AAAA,MACH,OAAO;AAAA,IACT,CAAC;AAAA,EACH;AAAA,EAEA,iBAAiB,eAA6B;AAC5C,SAAK,gBAAgB;AAAA,EACvB;AAAA,EAEA,cAAc,YAAsC;AAClD,SAAK,aAAa;AAAA,EACpB;AAAA,EAEU,cAAc,EAAE,QAAQ,OAAO,IAAiB,CAAC,GAAuB;AAChF,WAAO;AAAA,MACL,GAAG,KAAK;AAAA,MACR,GAAI,WAAW,UAAa,EAAE,OAAO;AAAA,MACrC,GAAI,WAAW,UAAa,EAAE,OAAO;AAAA,IACvC;AAAA,EACF;AAAA,EAEU,sBAAsB,SAAsB,CAAC,GAAiC;AACtF,UAAM,aAAa,KAAK,cAAc,MAAM;AAC5C,QAAI,CAAC,gBAAgB,UAAU,GAAG;AAChC,YAAM,IAAI,MAAM,+FAA+F;AAAA,IACjH;AACA,WAAO;AAAA,EACT;AAAA,EAEU,oBAAoB,EAAE,OAAO,IAAyB,CAAC,GAAuB;AACtF,WAAO;AAAA,MACL,GAAG,KAAK;AAAA,MACR,GAAI,WAAW,SAAY,EAAE,OAAO,IAAI,EAAE,QAAQ,KAAK,cAAc;AAAA,MACrE,QAAQ,2BAA2B;AAAA,IACrC;AAAA,EACF;AACF;","names":[]}