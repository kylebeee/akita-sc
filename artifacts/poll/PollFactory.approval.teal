#pragma version 10
intcblock 1 6 0

// This TEAL was generated by TEALScript v0.106.1
// https://github.com/algorandfoundation/TEALScript

// This contract is compliant with and/or implements the following ARCs: [ ARC4 ]

// The following ten lines of TEAL handle initial program flow
// This pattern is used to make it easy for anyone to parse the start of the program and determine if a specific action is allowed
// Here, action refers to the OnComplete in combination with whether the app is being created or called
// Every possible action for this contract is represented in the switch statement
// If the action is not implemented in the contract, its respective branch will be "*NOT_IMPLEMENTED" which just contains "err"
txn ApplicationID
!
intc 1 // 6
*
txn OnCompletion
+
switch *call_NoOp *NOT_IMPLEMENTED *NOT_IMPLEMENTED *NOT_IMPLEMENTED *NOT_IMPLEMENTED *NOT_IMPLEMENTED *create_NoOp *NOT_IMPLEMENTED *NOT_IMPLEMENTED *NOT_IMPLEMENTED *NOT_IMPLEMENTED *NOT_IMPLEMENTED

*NOT_IMPLEMENTED:
	// The requested action is not implemented in this contract. Are you using the correct OnComplete? Did you set your app ID?
	err

// mint(pay,uint64,uint64,uint64,uint64,string,string[])uint64
*abi_route_mint:
	// The ABI return prefix
	pushbytes 0x151f7c75

	// options: string[]
	txna ApplicationArgs 6

	// question: string
	txna ApplicationArgs 5
	extract 2 0

	// selectionMax: uint64
	txna ApplicationArgs 4
	btoi

	// endTime: uint64
	txna ApplicationArgs 3
	btoi

	// gateID: uint64
	txna ApplicationArgs 2
	btoi

	// type: uint64
	txna ApplicationArgs 1
	btoi

	// payment: pay
	txn GroupIndex
	intc 0 // 1
	-
	dup
	gtxns TypeEnum
	intc 0 //  pay
	==

	// argument 6 (payment) for mint must be a pay transaction
	assert

	// execute mint(pay,uint64,uint64,uint64,uint64,string,string[])uint64
	callsub mint
	itob
	concat
	log
	intc 0 // 1
	return

// mint(payment: PayTxn, type: PollType, gateID: uint64, endTime: uint64, selectionMax: uint64, question: string, options: string[]): AppID
mint:
	proto 7 1

	// contracts/poll/poll_factory.algo.ts:17
	// verifyPayTxn(payment, {
	//             receiver: this.app.address,
	//             amount: (
	//                 100_000 // requires 3 extra pages
	//                 + (28_500 * Poll.schema.global.numUint)
	//                 + (50_000 * Poll.schema.global.numByteSlice)
	//             ),
	//         })
	// verify receiver
	frame_dig -1 // payment: PayTxn
	gtxns Receiver
	global CurrentApplicationAddress
	==

	// transaction verification failed: {"txn":"payment","field":"receiver","expected":"this.app.address"}
	assert

	// verify amount
	frame_dig -1 // payment: PayTxn
	gtxns Amount
	pushint 713500
	==

	// transaction verification failed: {"txn":"payment","field":"amount","expected":"(\n                100_000 // requires 3 extra pages\n                + (28_500 * Poll.schema.global.numUint)\n                + (50_000 * Poll.schema.global.numByteSlice)\n            )"}
	assert

	// contracts/poll/poll_factory.algo.ts:26
	// sendMethodCall<typeof Poll.prototype.createApplication>({
	//             methodArgs: [
	//                 type,
	//                 endTime,
	//                 selectionMax,
	//                 question,
	//                 options,
	//                 gateID
	//             ],
	//             approvalProgram: Poll.approvalProgram(),
	//             clearStateProgram: Poll.clearProgram(),
	//             globalNumUint: Poll.schema.global.numUint,
	//             globalNumByteSlice: Poll.schema.global.numByteSlice,
	//             extraProgramPages: 0,
	//             fee: 0,
	//         })
	itxn_begin
	intc 1 //  appl
	itxn_field TypeEnum
	pushbytes 0xf4d27627 // method "createApplication(uint64,uint64,uint64,string,string[],uint64)void"
	itxn_field ApplicationArgs

	// contracts/poll/poll_factory.algo.ts:27
	// methodArgs: [
	//                 type,
	//                 endTime,
	//                 selectionMax,
	//                 question,
	//                 options,
	//                 gateID
	//             ]
	frame_dig -2 // type: PollType
	itob
	itxn_field ApplicationArgs
	frame_dig -4 // endTime: uint64
	itob
	itxn_field ApplicationArgs
	frame_dig -5 // selectionMax: uint64
	itob
	itxn_field ApplicationArgs
	frame_dig -6 // question: string
	dup
	len
	itob
	extract 6 2
	swap
	concat
	itxn_field ApplicationArgs
	frame_dig -7 // options: string[]
	itxn_field ApplicationArgs
	frame_dig -3 // gateID: uint64
	itob
	itxn_field ApplicationArgs

	// contracts/poll/poll_factory.algo.ts:35
	// approvalProgram: Poll.approvalProgram()
	pushbytes 0x0a20080100080203040605260c09626f785f636f756e7404747970650b766f7465735f74687265650a766f7465735f666f75720a766f7465735f6669766509766f7465735f6f6e6509766f7465735f74776f08656e645f74696d650c6d61785f73656c65637465640c6f7074696f6e5f636f756e7407676174655f69640031181421060b3119088d0c044100000000000000000000043300000000000000000000008a03018bfe23124100022289b12106b2108004200f7421b21a23b2188bffb21a8bfe16b21a8bfdb21a23b201b3b43b2209c53a5704002353898a0101b12106b2108004d574bb10b21a22b2188bffb21a23b201b3b43b2209c53a5704001789361a0617361a05361a04570200361a0317361a0217361a011788000222438a0600320d23134432078bfe0c448bff21050c44298bff67270a8bfa6727078bfe6780087175657374696f6e8bfc4915165706024c50678bfb2359250f494100088bfb235921070e10448bff2212494000068bff210412114100188bfd250f4941000a8bfd8bfb235922090e104427088bfd6727098bfb235967282367800a6f7074696f6e5f6f6e658bfb35ff2534ff34ff4f025925084934ff4c59220b2508585702004915165706024c5067800a6f7074696f6e5f74776f8bfb35ff210534ff34ff4f025925084934ff4c59220b2508585702004915165706024c50678bfb235921040f410033800c6f7074696f6e5f74687265658bfb35ff210634ff34ff4f025925084934ff4c59220b2508585702004915165706024c50678bfb235921050f410031800b6f7074696f6e5f666f75728bfb35ff2434ff34ff4f025925084934ff4c59220b2508585702004915165706024c50678bfb235921070f410032800b6f7074696f6e5f666976658bfb35ff810a34ff34ff4f025925084934ff4c59220b2508585702004915165706024c506789361a02361a015702003116220949381022124488000222438a0300270b4932072707640e443100bd4c4814448bfe15240a21070e494100088bfe15240a220f10448bfd270a64310088fda5448bff380881c47712448bff3807320a1244228c002964251249400006296421041211410007310088fdb38c002964231249400005296425121141008d8bfe15240a2212448bfe35ff34ff57000817231241000c270564220827054c674200678bfe35ff34ff57000817221241000c270664220827064c6742004c8bfe35ff34ff57000817251241000a2a6422082a4c674200338bfe35ff34ff5700081721041241000a2b6422082b4c674200198bfe35ff34ff57000817210512410009270464220827044c674200dd8bfe15240a2708640e44238c018b018bfe15240a0c4100c58bfe35ff238b01240b0834ff4c24581727096422090e448bfe35ff238b01240b0834ff4c245817231241000d2705648b000827054c674200838bfe35ff238b01240b0834ff4c245817221241000d2706648b000827064c674200618bfe35ff238b01240b0834ff4c245817251241000b2a648b00082a4c674200418bfe35ff238b01240b0834ff4c24581721041241000b2b648b00082b4c674200208bfe35ff238b01240b0834ff4c24581721051241000a2704648b000827044c678b0122088c0142ff30310023b94828642208284c6789361a0149158120124488000222438a010032072707640d448bffbc28642209284c67898004f4d27627361a008e01fc2000800455af84b980042a21d467361a008e02fdbbffba00
	itxn_field ApprovalProgram

	// contracts/poll/poll_factory.algo.ts:36
	// clearStateProgram: Poll.clearProgram()
	pushbytes 0x0a
	itxn_field ClearStateProgram

	// contracts/poll/poll_factory.algo.ts:37
	// globalNumUint: Poll.schema.global.numUint
	pushint 11
	itxn_field GlobalNumUint

	// contracts/poll/poll_factory.algo.ts:38
	// globalNumByteSlice: Poll.schema.global.numByteSlice
	intc 1 // 6
	itxn_field GlobalNumByteSlice

	// contracts/poll/poll_factory.algo.ts:39
	// extraProgramPages: 0
	intc 2 // 0
	itxn_field ExtraProgramPages

	// contracts/poll/poll_factory.algo.ts:40
	// fee: 0
	intc 2 // 0
	itxn_field Fee

	// Submit inner transaction
	itxn_submit

	// contracts/poll/poll_factory.algo.ts:44
	// return this.itxn.createdApplicationID;
	itxn CreatedApplicationID
	retsub

*abi_route_createApplication:
	intc 0 // 1
	return

*create_NoOp:
	pushbytes 0xb8447b36 // method "createApplication()void"
	txna ApplicationArgs 0
	match *abi_route_createApplication

	// this contract does not implement the given ABI method for create NoOp
	err

*call_NoOp:
	pushbytes 0x5ac8305d // method "mint(pay,uint64,uint64,uint64,uint64,string,string[])uint64"
	txna ApplicationArgs 0
	match *abi_route_mint

	// this contract does not implement the given ABI method for call NoOp
	err