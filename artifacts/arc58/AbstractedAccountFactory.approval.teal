#pragma version 10

// This TEAL was generated by TEALScript v0.103.0
// https://github.com/algorandfoundation/TEALScript

// This contract is compliant with and/or implements the following ARCs: [ ARC4 ]

// The following ten lines of TEAL handle initial program flow
// This pattern is used to make it easy for anyone to parse the start of the program and determine if a specific action is allowed
// Here, action refers to the OnComplete in combination with whether the app is being created or called
// Every possible action for this contract is represented in the switch statement
// If the action is not implemented in the contract, its respective branch will be "*NOT_IMPLEMENTED" which just contains "err"
txn ApplicationID
!
int 6
*
txn OnCompletion
+
switch *call_NoOp *NOT_IMPLEMENTED *NOT_IMPLEMENTED *NOT_IMPLEMENTED *call_UpdateApplication *NOT_IMPLEMENTED *create_NoOp *NOT_IMPLEMENTED *NOT_IMPLEMENTED *NOT_IMPLEMENTED *NOT_IMPLEMENTED *NOT_IMPLEMENTED

*NOT_IMPLEMENTED:
	// The requested action is not implemented in this contract. Are you using the correct OnComplete? Did you set your app ID?
	err

// createApplication(string,uint64)void
*abi_route_createApplication:
	// revocationAppID: uint64
	txna ApplicationArgs 2
	btoi

	// version: string
	txna ApplicationArgs 1
	extract 2 0

	// execute createApplication(string,uint64)void
	callsub createApplication
	int 1
	return

// createApplication(version: string, revocationAppID: AppID): void
createApplication:
	proto 2 0

	// contracts/arc58/abstracted_account_factory.algo.ts:10
	// this.abstractedAccountVersion.value = version
	byte 0x616273747261637465644163636f756e7456657273696f6e // "abstractedAccountVersion"
	frame_dig -1 // version: string
	dup
	len
	itob
	extract 6 2
	swap
	concat
	app_global_put

	// contracts/arc58/abstracted_account_factory.algo.ts:11
	// this.revocationAppID.value = revocationAppID
	byte 0x7265766f636174696f6e4170704944 // "revocationAppID"
	frame_dig -2 // revocationAppID: AppID
	app_global_put
	retsub

// updateApplication()void
*abi_route_updateApplication:
	// execute updateApplication()void
	callsub updateApplication
	int 1
	return

// updateApplication(): void
updateApplication:
	proto 0 0

	// contracts/arc58/abstracted_account_factory.algo.ts:15
	// assert(this.txn.sender === this.app.creator)
	txn Sender
	txna Applications 0
	app_params_get AppCreator
	pop
	==
	assert
	retsub

// mint(pay,address,address,string)uint64
*abi_route_mint:
	// The ABI return prefix
	byte 0x151f7c75

	// nickname: string
	txna ApplicationArgs 3
	extract 2 0

	// admin: address
	txna ApplicationArgs 2
	dup
	len
	int 32
	==

	// argument 1 (admin) for mint must be a address
	assert

	// controlledAddress: address
	txna ApplicationArgs 1
	dup
	len
	int 32
	==

	// argument 2 (controlledAddress) for mint must be a address
	assert

	// pmt: pay
	txn GroupIndex
	int 1
	-
	dup
	gtxns TypeEnum
	int pay
	==

	// argument 3 (pmt) for mint must be a pay transaction
	assert

	// execute mint(pay,address,address,string)uint64
	callsub mint
	itob
	concat
	log
	int 1
	return

// mint(pmt: PayTxn, controlledAddress: Address, admin: Address, nickname: string): AppID
mint:
	proto 4 1

	// contracts/arc58/abstracted_account_factory.algo.ts:20
	// assert(pmt.amount === (
	//                 200_000 // requires 1 extra page
	//                 + (28_500 * AbstractedAccount.schema.global.numUint)
	//                 + (50_000 * AbstractedAccount.schema.global.numByteSlice)
	//             )
	//         )
	frame_dig -1 // pmt: PayTxn
	gtxns Amount
	int 457000
	==
	assert

	// contracts/arc58/abstracted_account_factory.algo.ts:26
	// assert(pmt.receiver === this.app.address)
	frame_dig -1 // pmt: PayTxn
	gtxns Receiver
	global CurrentApplicationAddress
	==
	assert

	// contracts/arc58/abstracted_account_factory.algo.ts:28
	// sendMethodCall<typeof AbstractedAccount.prototype.createApplication>({
	//             methodArgs: [
	//                 this.abstractedAccountVersion.value,
	//                 controlledAddress,
	//                 admin,
	//                 this.revocationAppID.value,
	//                 nickname,
	//             ],
	//             approvalProgram: AbstractedAccount.approvalProgram(),
	//             clearStateProgram: AbstractedAccount.clearProgram(),
	//             globalNumUint: AbstractedAccount.schema.global.numUint,
	//             globalNumByteSlice: AbstractedAccount.schema.global.numByteSlice,
	//             extraProgramPages: 1,
	//             fee: 0,
	//         })
	itxn_begin
	int appl
	itxn_field TypeEnum
	method "createApplication(string,address,address,uint64,string)void"
	itxn_field ApplicationArgs

	// contracts/arc58/abstracted_account_factory.algo.ts:29
	// methodArgs: [
	//                 this.abstractedAccountVersion.value,
	//                 controlledAddress,
	//                 admin,
	//                 this.revocationAppID.value,
	//                 nickname,
	//             ]
	byte 0x616273747261637465644163636f756e7456657273696f6e // "abstractedAccountVersion"
	app_global_get
	extract 2 0
	dup
	len
	itob
	extract 6 2
	swap
	concat
	itxn_field ApplicationArgs
	frame_dig -2 // controlledAddress: Address
	itxn_field ApplicationArgs
	frame_dig -3 // admin: Address
	itxn_field ApplicationArgs
	byte 0x7265766f636174696f6e4170704944 // "revocationAppID"
	app_global_get
	itob
	itxn_field ApplicationArgs
	frame_dig -4 // nickname: string
	dup
	len
	itob
	extract 6 2
	swap
	concat
	itxn_field ApplicationArgs

	// contracts/arc58/abstracted_account_factory.algo.ts:36
	// approvalProgram: AbstractedAccount.approvalProgram()
	byte b64 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
	itxn_field ApprovalProgram

	// contracts/arc58/abstracted_account_factory.algo.ts:37
	// clearStateProgram: AbstractedAccount.clearProgram()
	byte b64 Cg==
	itxn_field ClearStateProgram

	// contracts/arc58/abstracted_account_factory.algo.ts:38
	// globalNumUint: AbstractedAccount.schema.global.numUint
	int 2
	itxn_field GlobalNumUint

	// contracts/arc58/abstracted_account_factory.algo.ts:39
	// globalNumByteSlice: AbstractedAccount.schema.global.numByteSlice
	int 4
	itxn_field GlobalNumByteSlice

	// contracts/arc58/abstracted_account_factory.algo.ts:40
	// extraProgramPages: 1
	int 1
	itxn_field ExtraProgramPages

	// contracts/arc58/abstracted_account_factory.algo.ts:41
	// fee: 0
	int 0
	itxn_field Fee

	// Submit inner transaction
	itxn_submit

	// contracts/arc58/abstracted_account_factory.algo.ts:44
	// return this.itxn.createdApplicationID;
	itxn CreatedApplicationID
	retsub

*create_NoOp:
	method "createApplication(string,uint64)void"
	txna ApplicationArgs 0
	match *abi_route_createApplication

	// this contract does not implement the given ABI method for create NoOp
	err

*call_NoOp:
	method "mint(pay,address,address,string)uint64"
	txna ApplicationArgs 0
	match *abi_route_mint

	// this contract does not implement the given ABI method for call NoOp
	err

*call_UpdateApplication:
	method "updateApplication()void"
	txna ApplicationArgs 0
	match *abi_route_updateApplication

	// this contract does not implement the given ABI method for call UpdateApplication
	err