#pragma version 10
intcblock 0 TMPL_factoryAppID 1 6 32 4
bytecblock 0x 0x3ea11832

// This TEAL was generated by TEALScript v0.106.1
// https://github.com/algorandfoundation/TEALScript

// This contract is compliant with and/or implements the following ARCs: [ ARC4 ]

// The following ten lines of TEAL handle initial program flow
// This pattern is used to make it easy for anyone to parse the start of the program and determine if a specific action is allowed
// Here, action refers to the OnComplete in combination with whether the app is being created or called
// Every possible action for this contract is represented in the switch statement
// If the action is not implemented in the contract, its respective branch will be "*NOT_IMPLEMENTED" which just contains "err"
txn ApplicationID
!
intc 3 // 6
*
txn OnCompletion
+
switch *call_NoOp *NOT_IMPLEMENTED *NOT_IMPLEMENTED *NOT_IMPLEMENTED *NOT_IMPLEMENTED *NOT_IMPLEMENTED *create_NoOp *NOT_IMPLEMENTED *NOT_IMPLEMENTED *NOT_IMPLEMENTED *NOT_IMPLEMENTED *NOT_IMPLEMENTED

*NOT_IMPLEMENTED:
	// The requested action is not implemented in this contract. Are you using the correct OnComplete? Did you set your app ID?
	err

// list(uint64,bool,uint64,uint64,uint64,uint64,string,byte[32][],address,uint64,uint64,address,uint64)uint64
*abi_route_list:
	// The ABI return prefix
	pushbytes 0x151f7c75

	// gateID: uint64
	txna ApplicationArgs 13
	btoi

	// reservedFor: address
	txna ApplicationArgs 12
	dup
	len
	intc 4 // 32
	==

	// argument 1 (reservedFor) for list must be a address
	assert

	// expirationRound: uint64
	txna ApplicationArgs 11
	btoi

	// marketplaceRoyalties: uint64
	txna ApplicationArgs 10
	btoi

	// marketplace: address
	txna ApplicationArgs 9
	dup
	len
	intc 4 // 32
	==

	// argument 4 (marketplace) for list must be a address
	assert

	// proof: byte[32][]
	txna ApplicationArgs 8
	extract 2 0

	// name: string
	txna ApplicationArgs 7
	extract 2 0

	// paymentAsset: uint64
	txna ApplicationArgs 6
	btoi

	// price: uint64
	txna ApplicationArgs 5
	btoi

	// assetAmount: uint64
	txna ApplicationArgs 4
	btoi

	// asset: uint64
	txna ApplicationArgs 3
	btoi

	// rekeyBack: bool
	txna ApplicationArgs 2
	dup
	len
	intc 2 // 1
	==

	// argument 11 (rekeyBack) for list must be a bool
	assert
	intc 0 // 0
	getbit

	// sender: uint64
	txna ApplicationArgs 1
	btoi

	// execute list(uint64,bool,uint64,uint64,uint64,uint64,string,byte[32][],address,uint64,uint64,address,uint64)uint64
	callsub list
	itob
	concat
	log
	intc 2 // 1
	return

// list(sender: AppID, rekeyBack: boolean, asset: AssetID, assetAmount: uint64, price: uint64, paymentAsset: AssetID, name: string, proof: bytes<32>[], marketplace: Address, marketplaceRoyalties: uint64, expirationRound: uint64, reservedFor: Address, gateID: uint64): AppID
list:
	proto 13 1

	// Push empty bytes after the frame pointer to reserve space for local variables
	bytec 0 // 0x
	dupn 3

	// contracts/arc58/plugins/marketplace.algo.ts:33
	// assert(sender.address.assetBalance(asset) >= assetAmount, errs.NOT_ENOUGH_ASSET)
	frame_dig -1 // sender: AppID
	app_params_get AppAddress
	pop
	frame_dig -3 // asset: AssetID
	asset_holding_get AssetBalance
	pop
	frame_dig -4 // assetAmount: uint64
	>=
	assert

	// contracts/arc58/plugins/marketplace.algo.ts:35
	// needsToOptIntoAsset = !this.factoryAppID.address.isOptedInToAsset(asset)
	intc 1 // TMPL_factoryAppID
	app_params_get AppAddress
	pop
	frame_dig -3 // asset: AssetID
	asset_holding_get AssetBalance
	swap
	pop
	!
	frame_bury 0 // needsToOptIntoAsset: bool

	// *if0_condition
	// contracts/arc58/plugins/marketplace.algo.ts:37
	// needsToOptIntoAsset
	frame_dig 0 // needsToOptIntoAsset: bool
	bz *if0_end

	// *if0_consequent
	// contracts/arc58/plugins/marketplace.algo.ts:38
	// this.pendingGroup.addMethodCall<typeof Marketplace.prototype.optin, void>({
	//                 sender: sender.address,
	//                 applicationID: this.factoryAppID,
	//                 methodArgs: [
	//                     {
	//                         sender: sender.address,
	//                         receiver: this.factoryAppID.address,
	//                         amount: globals.assetOptInMinBalance,
	//                         fee: 0,
	//                     },
	//                     asset
	//                 ],
	//                 fee: 0,
	//                 isFirstTxn: true
	//             })
	itxn_next
	intc 2 //  pay
	itxn_field TypeEnum

	// contracts/arc58/plugins/marketplace.algo.ts:43
	// sender: sender.address
	frame_dig -1 // sender: AppID
	app_params_get AppAddress
	pop
	itxn_field Sender

	// contracts/arc58/plugins/marketplace.algo.ts:44
	// receiver: this.factoryAppID.address
	intc 1 // TMPL_factoryAppID
	app_params_get AppAddress
	pop
	itxn_field Receiver

	// contracts/arc58/plugins/marketplace.algo.ts:45
	// amount: globals.assetOptInMinBalance
	global AssetOptInMinBalance
	itxn_field Amount

	// contracts/arc58/plugins/marketplace.algo.ts:46
	// fee: 0
	intc 0 // 0
	itxn_field Fee
	itxn_begin
	intc 3 //  appl
	itxn_field TypeEnum
	bytec 1 //  method "optin(pay,uint64)void"
	itxn_field ApplicationArgs

	// contracts/arc58/plugins/marketplace.algo.ts:39
	// sender: sender.address
	frame_dig -1 // sender: AppID
	app_params_get AppAddress
	pop
	itxn_field Sender

	// contracts/arc58/plugins/marketplace.algo.ts:40
	// applicationID: this.factoryAppID
	intc 1 // TMPL_factoryAppID
	itxn_field ApplicationID

	// contracts/arc58/plugins/marketplace.algo.ts:41
	// methodArgs: [
	//                     {
	//                         sender: sender.address,
	//                         receiver: this.factoryAppID.address,
	//                         amount: globals.assetOptInMinBalance,
	//                         fee: 0,
	//                     },
	//                     asset
	//                 ]
	frame_dig -3 // asset: AssetID
	itob
	itxn_field ApplicationArgs

	// contracts/arc58/plugins/marketplace.algo.ts:50
	// fee: 0
	intc 0 // 0
	itxn_field Fee

*if0_end:
	// contracts/arc58/plugins/marketplace.algo.ts:55
	// needsToOptIntoPaymentAsset = !this.factoryAppID.address.isOptedInToAsset(paymentAsset)
	intc 1 // TMPL_factoryAppID
	app_params_get AppAddress
	pop
	frame_dig -6 // paymentAsset: AssetID
	asset_holding_get AssetBalance
	swap
	pop
	!
	frame_bury 1 // needsToOptIntoPaymentAsset: bool

	// *if1_condition
	// contracts/arc58/plugins/marketplace.algo.ts:57
	// needsToOptIntoPaymentAsset
	frame_dig 1 // needsToOptIntoPaymentAsset: bool
	bz *if1_end

	// *if1_consequent
	// contracts/arc58/plugins/marketplace.algo.ts:58
	// this.pendingGroup.addMethodCall<typeof Marketplace.prototype.optin, void>({
	//                 sender: sender.address,
	//                 applicationID: this.factoryAppID,
	//                 methodArgs: [
	//                     {
	//                         sender: sender.address,
	//                         receiver: this.factoryAppID.address,
	//                         amount: globals.assetOptInMinBalance,
	//                         fee: 0,
	//                     },
	//                     paymentAsset
	//                 ],
	//                 fee: 0,
	//                 isFirstTxn: !needsToOptIntoAsset
	//             })
	itxn_next
	intc 2 //  pay
	itxn_field TypeEnum

	// contracts/arc58/plugins/marketplace.algo.ts:63
	// sender: sender.address
	frame_dig -1 // sender: AppID
	app_params_get AppAddress
	pop
	itxn_field Sender

	// contracts/arc58/plugins/marketplace.algo.ts:64
	// receiver: this.factoryAppID.address
	intc 1 // TMPL_factoryAppID
	app_params_get AppAddress
	pop
	itxn_field Receiver

	// contracts/arc58/plugins/marketplace.algo.ts:65
	// amount: globals.assetOptInMinBalance
	global AssetOptInMinBalance
	itxn_field Amount

	// contracts/arc58/plugins/marketplace.algo.ts:66
	// fee: 0
	intc 0 // 0
	itxn_field Fee
	itxn_begin
	intc 3 //  appl
	itxn_field TypeEnum
	bytec 1 //  method "optin(pay,uint64)void"
	itxn_field ApplicationArgs

	// contracts/arc58/plugins/marketplace.algo.ts:59
	// sender: sender.address
	frame_dig -1 // sender: AppID
	app_params_get AppAddress
	pop
	itxn_field Sender

	// contracts/arc58/plugins/marketplace.algo.ts:60
	// applicationID: this.factoryAppID
	intc 1 // TMPL_factoryAppID
	itxn_field ApplicationID

	// contracts/arc58/plugins/marketplace.algo.ts:61
	// methodArgs: [
	//                     {
	//                         sender: sender.address,
	//                         receiver: this.factoryAppID.address,
	//                         amount: globals.assetOptInMinBalance,
	//                         fee: 0,
	//                     },
	//                     paymentAsset
	//                 ]
	frame_dig -6 // paymentAsset: AssetID
	itob
	itxn_field ApplicationArgs

	// contracts/arc58/plugins/marketplace.algo.ts:70
	// fee: 0
	intc 0 // 0
	itxn_field Fee

*if1_end:
	// contracts/arc58/plugins/marketplace.algo.ts:75
	// optinMBR = (paymentAsset.id === 0)
	//             ? (globals.assetOptInMinBalance)
	//             : (globals.assetOptInMinBalance * 2)
	frame_dig -6 // paymentAsset: AssetID
	intc 0 // 0
	==
	bz *ternary0_false
	global AssetOptInMinBalance
	b *ternary0_end

*ternary0_false:
	global AssetOptInMinBalance
	pushint 2
	*

*ternary0_end:
	frame_bury 2 // optinMBR: uint64

	// contracts/arc58/plugins/marketplace.algo.ts:79
	// childContractMBR = (
	//             100_000
	//             + (28_500 * Listing.schema.global.numUint)
	//             + (50_000 * Listing.schema.global.numByteSlice)
	//             + optinMBR
	//         )
	pushint 478000
	frame_dig 2 // optinMBR: uint64
	+
	frame_bury 3 // childContractMBR: uint64

	// contracts/arc58/plugins/marketplace.algo.ts:86
	// this.pendingGroup.addMethodCall<typeof Marketplace.prototype.list, AppID>({
	//             sender: sender.address,
	//             applicationID: this.factoryAppID,
	//             methodArgs: [
	//                 {
	//                     sender: sender.address,
	//                     receiver: this.factoryAppID.address,
	//                     amount: childContractMBR,
	//                     fee: 0,
	//                 },
	//                 {
	//                     sender: sender.address,
	//                     assetReceiver: this.factoryAppID.address,
	//                     assetAmount: assetAmount,
	//                     xferAsset: asset,
	//                     fee: 0,
	//                 },
	//                 price,
	//                 paymentAsset,
	//                 name,
	//                 proof,
	//                 marketplace,
	//                 expirationRound,
	//                 reservedFor,
	//                 gateID,
	//             ],
	//             approvalProgram: Listing.approvalProgram(),
	//             clearStateProgram: Listing.clearProgram(),
	//             globalNumUint: Listing.schema.global.numUint,
	//             globalNumByteSlice: Listing.schema.global.numByteSlice,
	//             extraProgramPages: 0,
	//             rekeyTo: rekeyBack ? sender.address : Address.zeroAddress,
	//             fee: 0,
	//             isFirstTxn: !needsToOptIntoAsset && !needsToOptIntoPaymentAsset,
	//         })
	itxn_next
	intc 2 //  pay
	itxn_field TypeEnum

	// contracts/arc58/plugins/marketplace.algo.ts:91
	// sender: sender.address
	frame_dig -1 // sender: AppID
	app_params_get AppAddress
	pop
	itxn_field Sender

	// contracts/arc58/plugins/marketplace.algo.ts:92
	// receiver: this.factoryAppID.address
	intc 1 // TMPL_factoryAppID
	app_params_get AppAddress
	pop
	itxn_field Receiver

	// contracts/arc58/plugins/marketplace.algo.ts:93
	// amount: childContractMBR
	frame_dig 3 // childContractMBR: uint64
	itxn_field Amount

	// contracts/arc58/plugins/marketplace.algo.ts:94
	// fee: 0
	intc 0 // 0
	itxn_field Fee
	itxn_next
	intc 5 //  axfer
	itxn_field TypeEnum

	// contracts/arc58/plugins/marketplace.algo.ts:97
	// sender: sender.address
	frame_dig -1 // sender: AppID
	app_params_get AppAddress
	pop
	itxn_field Sender

	// contracts/arc58/plugins/marketplace.algo.ts:98
	// assetReceiver: this.factoryAppID.address
	intc 1 // TMPL_factoryAppID
	app_params_get AppAddress
	pop
	itxn_field AssetReceiver

	// contracts/arc58/plugins/marketplace.algo.ts:99
	// assetAmount: assetAmount
	frame_dig -4 // assetAmount: uint64
	itxn_field AssetAmount

	// contracts/arc58/plugins/marketplace.algo.ts:100
	// xferAsset: asset
	frame_dig -3 // asset: AssetID
	itxn_field XferAsset

	// contracts/arc58/plugins/marketplace.algo.ts:101
	// fee: 0
	intc 0 // 0
	itxn_field Fee
	itxn_begin
	intc 3 //  appl
	itxn_field TypeEnum
	pushbytes 0xfd8466fa // method "list(pay,axfer,uint64,uint64,string,byte[32][],address,uint64,address,uint64)uint64"
	itxn_field ApplicationArgs

	// contracts/arc58/plugins/marketplace.algo.ts:87
	// sender: sender.address
	frame_dig -1 // sender: AppID
	app_params_get AppAddress
	pop
	itxn_field Sender

	// contracts/arc58/plugins/marketplace.algo.ts:88
	// applicationID: this.factoryAppID
	intc 1 // TMPL_factoryAppID
	itxn_field ApplicationID

	// contracts/arc58/plugins/marketplace.algo.ts:89
	// methodArgs: [
	//                 {
	//                     sender: sender.address,
	//                     receiver: this.factoryAppID.address,
	//                     amount: childContractMBR,
	//                     fee: 0,
	//                 },
	//                 {
	//                     sender: sender.address,
	//                     assetReceiver: this.factoryAppID.address,
	//                     assetAmount: assetAmount,
	//                     xferAsset: asset,
	//                     fee: 0,
	//                 },
	//                 price,
	//                 paymentAsset,
	//                 name,
	//                 proof,
	//                 marketplace,
	//                 expirationRound,
	//                 reservedFor,
	//                 gateID,
	//             ]
	frame_dig -5 // price: uint64
	itob
	itxn_field ApplicationArgs
	frame_dig -6 // paymentAsset: AssetID
	itob
	itxn_field ApplicationArgs
	frame_dig -7 // name: string
	dup
	len
	itob
	extract 6 2
	swap
	concat
	itxn_field ApplicationArgs
	frame_dig -8 // proof: bytes<32>[]
	dup
	len
	intc 4 // 32
	/
	itob
	extract 6 2
	swap
	concat
	itxn_field ApplicationArgs
	frame_dig -9 // marketplace: Address
	itxn_field ApplicationArgs
	frame_dig -11 // expirationRound: uint64
	itob
	itxn_field ApplicationArgs
	frame_dig -12 // reservedFor: Address
	itxn_field ApplicationArgs
	frame_dig -13 // gateID: uint64
	itob
	itxn_field ApplicationArgs

	// contracts/arc58/plugins/marketplace.algo.ts:112
	// approvalProgram: Listing.approvalProgram()
	pushbytes 0x0a20060001042006904e260c0d7061796d656e745f6173736574000673656c6c65720561737365740570726963651065787069726174696f6e5f726f756e640c72657365727665645f666f720b6d61726b6574706c61636510616b6974615f64616f5f6170705f69640f63726561746f725f726f79616c747907676174655f69640408531ed731181421040b3119088d0c06d5000000000000000006eb06c700000000000000000000008a03018bfe22124100022389b12104b2108004200f7421b21a22b2188bffb21a8bfe16b21a8bfdb21a22b201b3b43b2309c53a570400225389361a01173116230949381023124488000223438a0200310036320072074812448bff3807320a12448bff380832101244b124b210320ab200320ab21422b2128bfeb21122b201b3898a0400294704228c00b12104b2108004caa8daa5b21a22b2188bffb21a8bfe16b21a22b201b3b43b2309c53a5704008c018b0135ff34ff570808178c028b0135ff34ff818001538c038b0135ff34ff571108178c048b02494000038b0411410014b623b21022720848b2078b028b0408b20822b2018b0314410018b62104b2108004e8540810b21a22b2188bfe16b21a22b2018bfc410036b624b21022720848b21522720848b2148bfdb2128bfeb21122b201b62104b210270bb21a22b2188bffb21a8b0416b21a22b20142002db624b21022720848b2148bfdb2128bfeb21122b201b62104b210270bb21a22b2188bffb21a8b0416b21a22b201b3898a0001286422124100042342000122898a0101b12104b2108004d574bb10b21a23b2188bffb21a22b201b3b43b2309c53a57040017898a01012947088bff2709641d2221051f48484c14448c008b00221249410006270964220d10494100058bff220d10410003238c0027086480236d61726b6574706c6163655f73616c655f70657263656e746167655f6d696e696d756d65448c0127086480236d61726b6574706c6163655f73616c655f70657263656e746167655f6d6178696d756d65448c022a6488ff498c038b028b028b01098b0323091d2281e7071f48484c1444098c048bff8b041d2221051f48484c14448c058b052212494100058bff220d10410003238c0527086480216d61726b6574706c6163655f636f6d706f7361626c655f70657263656e7461676565448c068bff8b061d2221051f48484c14448c078b0722124941001b80156d61726b6574706c6163655f726f79616c7469657364220d10494100058bff220d10410003238c072704648b008b050881028b070b08098c088b00168b0716508b0816508c004608898a01008bff2b6470004c48410020b124b2108bffb2158bffb214320a2b64700048b2122b64b21122b201b342000f23320a2b647000482b648bff88fd34898a01002927046488fe5c8c00b123b2108b0057000817b2082b64710b48b20722b201b3b123b2108b0057080817b208270764b20722b201b3b123b2108b0057080817b2088bffb20722b201b3b123b2102a64b2098b0057100817b20822b2012b64710448800520536f6c6450b205b3898a01002927046488fdec8c002b64710b48286470004c4841001eb124b2102b64710b48b2148b0057000817b2122864b21122b201b3420011228b005700081728642b64710b4888fc7a270764286470004c4841001cb124b210270764b2148b0057080817b2122864b21122b201b342000f228b0057080817286427076488fc438bff286470004c4841001bb124b2108bffb2148b0057080817b2122864b21122b201b342000e228b005708081728648bff88fc0f2a64286470004c4841001fb124b2102a64b2152a64b2148b0057100817b2122864b21122b201b342000e238b005710081728642a6488fbd7b123b2102a64b20922b201b389361a0a17361a094915251244361a0817361a074915251244361a0617361a0517361a0417361a034915251244361a0217361a011788000223438a0a00320d22134427088bff672b8bfe672a8bfd6727048bfc67288bfb6727098bfa6727078bf9678bf82212494000068bf832060d114427058bf86727068bf767270a8bf66789361a03361a024915251244361a0149152512443116230949381023124488000223438a0400310032091244286422124427056422124940000727056432060d11448bfc270a648bfe88fa7e442706643203134100078bfe27066412448bff380036320072074812448bff380827046412448bff3807320a12448bfe88fd5b8bfd88fd9489361a03361a024915251244361a0149152512443116230949381024124488000223438a0400310032091244286422134427056422124940000727056432060d11448bfc270a648bfe88f9fa442706643203134100078bfe27066412448bff380036320072074812448bff381227046412448bff3814320a12448bfe88fcd78bfd88fd8089361a01491525124488000223438a01003100320912442a648bff1244b124b2102a64b2142a64b215320a2b64700048b2122b64b21122b20188fb041441001cb624b2102a64b2142a64b215320a2864700048b2122864b21122b201b623b2102a64b209320a730048b20822b201b389361a011788000223438a010031002a64124427048bff678980041d0a6f59361a008e01fde40080043ea11832800419396c4a361a008e02f950ffc5008004ef0078a98004b8a7cc09800468e86343361a008e03fe30feb4ff3800
	itxn_field ApprovalProgram

	// contracts/arc58/plugins/marketplace.algo.ts:113
	// clearStateProgram: Listing.clearProgram()
	pushbytes 0x0a
	itxn_field ClearStateProgram

	// contracts/arc58/plugins/marketplace.algo.ts:114
	// globalNumUint: Listing.schema.global.numUint
	pushint 8
	itxn_field GlobalNumUint

	// contracts/arc58/plugins/marketplace.algo.ts:115
	// globalNumByteSlice: Listing.schema.global.numByteSlice
	pushint 3
	itxn_field GlobalNumByteSlice

	// contracts/arc58/plugins/marketplace.algo.ts:116
	// extraProgramPages: 0
	intc 0 // 0
	itxn_field ExtraProgramPages

	// contracts/arc58/plugins/marketplace.algo.ts:117
	// rekeyTo: rekeyBack ? sender.address : Address.zeroAddress
	frame_dig -2 // rekeyBack: boolean
	bz *ternary1_false
	frame_dig -1 // sender: AppID
	app_params_get AppAddress
	pop
	b *ternary1_end

*ternary1_false:
	global ZeroAddress

*ternary1_end:
	itxn_field RekeyTo

	// contracts/arc58/plugins/marketplace.algo.ts:118
	// fee: 0
	intc 0 // 0
	itxn_field Fee

	// contracts/arc58/plugins/marketplace.algo.ts:122
	// this.pendingGroup.submit()
	itxn_submit

	// contracts/arc58/plugins/marketplace.algo.ts:124
	// return this.itxn.createdApplicationID;
	itxn CreatedApplicationID

	// set the subroutine return value
	frame_bury 0

	// pop all local variables from the stack
	popn 3
	retsub

// purchase(uint64,bool,uint64,address,byte[][])void
*abi_route_purchase:
	// args: byte[][]
	txna ApplicationArgs 5

	// marketplace: address
	txna ApplicationArgs 4
	dup
	len
	intc 4 // 32
	==

	// argument 1 (marketplace) for purchase must be a address
	assert

	// listingAppID: uint64
	txna ApplicationArgs 3
	btoi

	// rekeyBack: bool
	txna ApplicationArgs 2
	dup
	len
	intc 2 // 1
	==

	// argument 3 (rekeyBack) for purchase must be a bool
	assert
	intc 0 // 0
	getbit

	// sender: uint64
	txna ApplicationArgs 1
	btoi

	// execute purchase(uint64,bool,uint64,address,byte[][])void
	callsub purchase
	intc 2 // 1
	return

// purchase(sender: AppID, rekeyBack: boolean, listingAppID: AppID, marketplace: Address, args: bytes[]): void
purchase:
	proto 5 0

	// Push empty bytes after the frame pointer to reserve space for local variables
	bytec 0 // 0x
	dup

	// contracts/arc58/plugins/marketplace.algo.ts:134
	// assert(listingAppID.creator === this.factoryAppID.address, errs.LISTING_CREATOR_NOT_MARKETPLACE)
	frame_dig -3 // listingAppID: AppID
	app_params_get AppCreator
	pop
	intc 1 // TMPL_factoryAppID
	app_params_get AppAddress
	pop
	==
	assert

	// contracts/arc58/plugins/marketplace.algo.ts:136
	// price = listingAppID.globalState(AKITA_LISTING_PRICE_KEY) as uint64
	frame_dig -3 // listingAppID: AppID
	pushbytes "price"
	app_global_get_ex

	// global state value does not exist: listingAppID.globalState(AKITA_LISTING_PRICE_KEY)
	assert
	frame_bury 0 // price: uint64

	// contracts/arc58/plugins/marketplace.algo.ts:137
	// paymentAsset = listingAppID.globalState(AKITA_LISTING_PAYMENT_ASSET_KEY) as AssetID
	frame_dig -3 // listingAppID: AppID
	pushbytes "payment_asset"
	app_global_get_ex

	// global state value does not exist: listingAppID.globalState(AKITA_LISTING_PAYMENT_ASSET_KEY)
	assert
	frame_bury 1 // paymentAsset: uint64

	// *if2_condition
	// contracts/arc58/plugins/marketplace.algo.ts:139
	// paymentAsset.id === 0
	frame_dig 1 // paymentAsset: uint64
	intc 0 // 0
	==
	bz *if2_else

	// *if2_consequent
	// contracts/arc58/plugins/marketplace.algo.ts:140
	// sendMethodCall<typeof Marketplace.prototype.purchase, void>({
	//                 sender: sender.address,
	//                 applicationID: this.factoryAppID,
	//                 methodArgs: [
	//                     {
	//                         sender: sender.address,
	//                         receiver: this.factoryAppID.address,
	//                         amount: price,
	//                         fee: 0,
	//                     },
	//                     listingAppID,
	//                     marketplace,
	//                     args
	//                 ],
	//                 rekeyTo: rekeyBack ? sender.address : Address.zeroAddress,
	//                 fee: 0,
	//             })
	itxn_begin
	intc 2 //  pay
	itxn_field TypeEnum

	// contracts/arc58/plugins/marketplace.algo.ts:145
	// sender: sender.address
	frame_dig -1 // sender: AppID
	app_params_get AppAddress
	pop
	itxn_field Sender

	// contracts/arc58/plugins/marketplace.algo.ts:146
	// receiver: this.factoryAppID.address
	intc 1 // TMPL_factoryAppID
	app_params_get AppAddress
	pop
	itxn_field Receiver

	// contracts/arc58/plugins/marketplace.algo.ts:147
	// amount: price
	frame_dig 0 // price: uint64
	itxn_field Amount

	// contracts/arc58/plugins/marketplace.algo.ts:148
	// fee: 0
	intc 0 // 0
	itxn_field Fee
	itxn_next
	intc 3 //  appl
	itxn_field TypeEnum
	pushbytes 0x6c873300 // method "purchase(pay,uint64,address,byte[][])void"
	itxn_field ApplicationArgs

	// contracts/arc58/plugins/marketplace.algo.ts:141
	// sender: sender.address
	frame_dig -1 // sender: AppID
	app_params_get AppAddress
	pop
	itxn_field Sender

	// contracts/arc58/plugins/marketplace.algo.ts:142
	// applicationID: this.factoryAppID
	intc 1 // TMPL_factoryAppID
	itxn_field ApplicationID

	// contracts/arc58/plugins/marketplace.algo.ts:143
	// methodArgs: [
	//                     {
	//                         sender: sender.address,
	//                         receiver: this.factoryAppID.address,
	//                         amount: price,
	//                         fee: 0,
	//                     },
	//                     listingAppID,
	//                     marketplace,
	//                     args
	//                 ]
	frame_dig -3 // listingAppID: AppID
	itob
	itxn_field ApplicationArgs
	frame_dig -4 // marketplace: Address
	itxn_field ApplicationArgs
	frame_dig -5 // args: bytes[]
	itxn_field ApplicationArgs

	// contracts/arc58/plugins/marketplace.algo.ts:154
	// rekeyTo: rekeyBack ? sender.address : Address.zeroAddress
	frame_dig -2 // rekeyBack: boolean
	bz *ternary2_false
	frame_dig -1 // sender: AppID
	app_params_get AppAddress
	pop
	b *ternary2_end

*ternary2_false:
	global ZeroAddress

*ternary2_end:
	itxn_field RekeyTo

	// contracts/arc58/plugins/marketplace.algo.ts:155
	// fee: 0
	intc 0 // 0
	itxn_field Fee

	// Submit inner transaction
	itxn_submit
	b *if2_end

*if2_else:
	// contracts/arc58/plugins/marketplace.algo.ts:158
	// sendMethodCall<typeof Marketplace.prototype.purchaseAsa, void>({
	//                 sender: sender.address,
	//                 applicationID: this.factoryAppID,
	//                 methodArgs: [
	//                     {
	//                         sender: sender.address,
	//                         assetReceiver: this.factoryAppID.address,
	//                         assetAmount: price,
	//                         xferAsset: paymentAsset,
	//                     },
	//                     listingAppID,
	//                     marketplace,
	//                     args
	//                 ],
	//                 rekeyTo: rekeyBack ? sender.address : Address.zeroAddress,
	//                 fee: 0,
	//             })
	itxn_begin
	intc 5 //  axfer
	itxn_field TypeEnum

	// contracts/arc58/plugins/marketplace.algo.ts:163
	// sender: sender.address
	frame_dig -1 // sender: AppID
	app_params_get AppAddress
	pop
	itxn_field Sender

	// contracts/arc58/plugins/marketplace.algo.ts:164
	// assetReceiver: this.factoryAppID.address
	intc 1 // TMPL_factoryAppID
	app_params_get AppAddress
	pop
	itxn_field AssetReceiver

	// contracts/arc58/plugins/marketplace.algo.ts:165
	// assetAmount: price
	frame_dig 0 // price: uint64
	itxn_field AssetAmount

	// contracts/arc58/plugins/marketplace.algo.ts:166
	// xferAsset: paymentAsset
	frame_dig 1 // paymentAsset: uint64
	itxn_field XferAsset

	// Fee field not set, defaulting to 0
	intc 0 // 0
	itxn_field Fee
	itxn_next
	intc 3 //  appl
	itxn_field TypeEnum
	pushbytes 0x8dc9339f // method "purchaseAsa(axfer,uint64,address,byte[][])void"
	itxn_field ApplicationArgs

	// contracts/arc58/plugins/marketplace.algo.ts:159
	// sender: sender.address
	frame_dig -1 // sender: AppID
	app_params_get AppAddress
	pop
	itxn_field Sender

	// contracts/arc58/plugins/marketplace.algo.ts:160
	// applicationID: this.factoryAppID
	intc 1 // TMPL_factoryAppID
	itxn_field ApplicationID

	// contracts/arc58/plugins/marketplace.algo.ts:161
	// methodArgs: [
	//                     {
	//                         sender: sender.address,
	//                         assetReceiver: this.factoryAppID.address,
	//                         assetAmount: price,
	//                         xferAsset: paymentAsset,
	//                     },
	//                     listingAppID,
	//                     marketplace,
	//                     args
	//                 ]
	frame_dig -3 // listingAppID: AppID
	itob
	itxn_field ApplicationArgs
	frame_dig -4 // marketplace: Address
	itxn_field ApplicationArgs
	frame_dig -5 // args: bytes[]
	itxn_field ApplicationArgs

	// contracts/arc58/plugins/marketplace.algo.ts:172
	// rekeyTo: rekeyBack ? sender.address : Address.zeroAddress
	frame_dig -2 // rekeyBack: boolean
	bz *ternary3_false
	frame_dig -1 // sender: AppID
	app_params_get AppAddress
	pop
	b *ternary3_end

*ternary3_false:
	global ZeroAddress

*ternary3_end:
	itxn_field RekeyTo

	// contracts/arc58/plugins/marketplace.algo.ts:173
	// fee: 0
	intc 0 // 0
	itxn_field Fee

	// Submit inner transaction
	itxn_submit

*if2_end:
	retsub

// changePrice(uint64,bool,uint64,uint64)void
*abi_route_changePrice:
	// price: uint64
	txna ApplicationArgs 4
	btoi

	// listingAppID: uint64
	txna ApplicationArgs 3
	btoi

	// rekeyBack: bool
	txna ApplicationArgs 2
	dup
	len
	intc 2 // 1
	==

	// argument 2 (rekeyBack) for changePrice must be a bool
	assert
	intc 0 // 0
	getbit

	// sender: uint64
	txna ApplicationArgs 1
	btoi

	// execute changePrice(uint64,bool,uint64,uint64)void
	callsub changePrice
	intc 2 // 1
	return

// changePrice(sender: AppID, rekeyBack: boolean, listingAppID: AppID, price: uint64): void
changePrice:
	proto 4 0

	// contracts/arc58/plugins/marketplace.algo.ts:179
	// assert(listingAppID.creator === this.factoryAppID.address, errs.LISTING_CREATOR_NOT_MARKETPLACE)
	frame_dig -3 // listingAppID: AppID
	app_params_get AppCreator
	pop
	intc 1 // TMPL_factoryAppID
	app_params_get AppAddress
	pop
	==
	assert

	// contracts/arc58/plugins/marketplace.algo.ts:181
	// sendMethodCall<typeof Listing.prototype.changePrice, void>({
	//             sender: sender.address,
	//             applicationID: listingAppID,
	//             methodArgs: [ price ],
	//             rekeyTo: rekeyBack ? sender.address : Address.zeroAddress,
	//             fee: 0,
	//         })
	itxn_begin
	intc 3 //  appl
	itxn_field TypeEnum
	pushbytes 0x19396c4a // method "changePrice(uint64)void"
	itxn_field ApplicationArgs

	// contracts/arc58/plugins/marketplace.algo.ts:182
	// sender: sender.address
	frame_dig -1 // sender: AppID
	app_params_get AppAddress
	pop
	itxn_field Sender

	// contracts/arc58/plugins/marketplace.algo.ts:183
	// applicationID: listingAppID
	frame_dig -3 // listingAppID: AppID
	itxn_field ApplicationID

	// contracts/arc58/plugins/marketplace.algo.ts:184
	// methodArgs: [ price ]
	frame_dig -4 // price: uint64
	itob
	itxn_field ApplicationArgs

	// contracts/arc58/plugins/marketplace.algo.ts:185
	// rekeyTo: rekeyBack ? sender.address : Address.zeroAddress
	frame_dig -2 // rekeyBack: boolean
	bz *ternary4_false
	frame_dig -1 // sender: AppID
	app_params_get AppAddress
	pop
	b *ternary4_end

*ternary4_false:
	global ZeroAddress

*ternary4_end:
	itxn_field RekeyTo

	// contracts/arc58/plugins/marketplace.algo.ts:186
	// fee: 0
	intc 0 // 0
	itxn_field Fee

	// Submit inner transaction
	itxn_submit
	retsub

// delist(uint64,bool,uint64)void
*abi_route_delist:
	// listingAppID: uint64
	txna ApplicationArgs 3
	btoi

	// rekeyBack: bool
	txna ApplicationArgs 2
	dup
	len
	intc 2 // 1
	==

	// argument 1 (rekeyBack) for delist must be a bool
	assert
	intc 0 // 0
	getbit

	// sender: uint64
	txna ApplicationArgs 1
	btoi

	// execute delist(uint64,bool,uint64)void
	callsub delist
	intc 2 // 1
	return

// delist(sender: AppID, rekeyBack: boolean, listingAppID: AppID): void
delist:
	proto 3 0

	// contracts/arc58/plugins/marketplace.algo.ts:191
	// assert(listingAppID.creator === this.factoryAppID.address, errs.LISTING_CREATOR_NOT_MARKETPLACE)
	frame_dig -3 // listingAppID: AppID
	app_params_get AppCreator
	pop
	intc 1 // TMPL_factoryAppID
	app_params_get AppAddress
	pop
	==
	assert

	// contracts/arc58/plugins/marketplace.algo.ts:193
	// sendMethodCall<typeof Marketplace.prototype.delist, void>({
	//             sender: sender.address,
	//             applicationID: listingAppID,
	//             rekeyTo: rekeyBack ? sender.address : Address.zeroAddress,
	//             fee: 0,
	//         })
	itxn_begin
	intc 3 //  appl
	itxn_field TypeEnum
	pushbytes 0xc97dbb2e // method "delist(uint64)void"
	itxn_field ApplicationArgs

	// contracts/arc58/plugins/marketplace.algo.ts:194
	// sender: sender.address
	frame_dig -1 // sender: AppID
	app_params_get AppAddress
	pop
	itxn_field Sender

	// contracts/arc58/plugins/marketplace.algo.ts:195
	// applicationID: listingAppID
	frame_dig -3 // listingAppID: AppID
	itxn_field ApplicationID

	// contracts/arc58/plugins/marketplace.algo.ts:196
	// rekeyTo: rekeyBack ? sender.address : Address.zeroAddress
	frame_dig -2 // rekeyBack: boolean
	bz *ternary5_false
	frame_dig -1 // sender: AppID
	app_params_get AppAddress
	pop
	b *ternary5_end

*ternary5_false:
	global ZeroAddress

*ternary5_end:
	itxn_field RekeyTo

	// contracts/arc58/plugins/marketplace.algo.ts:197
	// fee: 0
	intc 0 // 0
	itxn_field Fee

	// Submit inner transaction
	itxn_submit
	retsub

*abi_route_createApplication:
	intc 2 // 1
	return

*create_NoOp:
	pushbytes 0xb8447b36 // method "createApplication()void"
	txna ApplicationArgs 0
	match *abi_route_createApplication

	// this contract does not implement the given ABI method for create NoOp
	err

*call_NoOp:
	pushbytes 0xb8c57b76 // method "list(uint64,bool,uint64,uint64,uint64,uint64,string,byte[32][],address,uint64,uint64,address,uint64)uint64"
	pushbytes 0x269e4bb0 // method "purchase(uint64,bool,uint64,address,byte[][])void"
	pushbytes 0x4d96ba44 // method "changePrice(uint64,bool,uint64,uint64)void"
	pushbytes 0x59466ef2 // method "delist(uint64,bool,uint64)void"
	txna ApplicationArgs 0
	match *abi_route_list *abi_route_purchase *abi_route_changePrice *abi_route_delist

	// this contract does not implement the given ABI method for call NoOp
	err